<!DOCTYPE html><html lang="ko-KR" mode="light" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="일 전"><meta name="hour-prompt" content="시간 전"><meta name="minute-prompt" content="분 전"><meta name="justnow-prompt" content="방금"><meta name="generator" content="Jekyll v4.2.1" /><meta property="og:title" content="Nginx의 limit_req 모듈 사용기" /><meta name="author" content="bactoria" /><meta property="og:locale" content="ko_KR" /><meta name="description" content="이슈 발생" /><meta property="og:description" content="이슈 발생" /><link rel="canonical" href="https://bactoria.github.io/2020/01/19/Nginx%EC%9D%98-limit_req-%EB%AA%A8%EB%93%88-%EC%82%AC%EC%9A%A9%EA%B8%B0/" /><meta property="og:url" content="https://bactoria.github.io/2020/01/19/Nginx%EC%9D%98-limit_req-%EB%AA%A8%EB%93%88-%EC%82%AC%EC%9A%A9%EA%B8%B0/" /><meta property="og:site_name" content="Bactoria" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2020-01-19T20:11:31+00:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Nginx의 limit_req 모듈 사용기" /><meta name="twitter:site" content="@twitter_username" /><meta name="twitter:creator" content="@bactoria" /><meta name="google-site-verification" content="google7bf670670a870e33.html" /> <script type="application/ld+json"> {"author":{"@type":"Person","name":"bactoria"},"description":"이슈 발생","url":"https://bactoria.github.io/2020/01/19/Nginx%EC%9D%98-limit_req-%EB%AA%A8%EB%93%88-%EC%82%AC%EC%9A%A9%EA%B8%B0/","@type":"BlogPosting","headline":"Nginx의 limit_req 모듈 사용기","dateModified":"2020-01-19T15:17:27+00:00","datePublished":"2020-01-19T20:11:31+00:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://bactoria.github.io/2020/01/19/Nginx%EC%9D%98-limit_req-%EB%AA%A8%EB%93%88-%EC%82%AC%EC%9A%A9%EA%B8%B0/"},"@context":"https://schema.org"}</script><title>Nginx의 limit_req 모듈 사용기 | Bactoria</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Bactoria"><meta name="application-name" content="Bactoria"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="ko-KR"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="https://avatars.githubusercontent.com/u/25674959?v=4" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Bactoria</a></div><div class="site-subtitle font-italic">for Self-Motivation</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>홈</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>카테고리</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>태그</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>아카이브</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>정보</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/bactoria" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['bactoria','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> 홈 </a> </span> <span>Nginx의 limit_req 모듈 사용기</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> 포스트</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="검색..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >취소</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Nginx의 limit_req 모듈 사용기</h1><div class="post-meta text-muted"><div> By <em> <a href="https://github.com/bactoria">bactoria</a> </em></div><div class="d-flex"><div> <span> 게시 <em class="timeago" date="2020-01-19 20:11:31 +0000" data-toggle="tooltip" data-placement="bottom" title="2020-01-19, 20:11 +0000" >2020년 01월 19일</em> </span> <span> 업데이트 <em class="timeago" date="2020-01-20 00:17:27 +0900 " data-toggle="tooltip" data-placement="bottom" title="2020-01-20, 00:17 +0900" >2020년 01월 20일</em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1678 단어"> <em>9 분</em>읽는 시간</span></div></div></div><div class="post-content"><h3 id="이슈-발생">이슈 발생<a href="#이슈-발생" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><p>두 달전에 있었던 일이다. 프로젝트의 발표를 위해 서버를 로컬에 배포해 두었고, 발표를 듣는 이들에게 데모를 체험할 수 있도록 링크를 알려주었다.</p><p>그런데 발표 도중에 <strong>서버로 응답이 오지 않는 이슈</strong>가 발생했으며 서버로 요청하는 모든 기능이 마비되었다.</p><p>발표가 끝난 후 노트북을 보니, 아래 로그가 계속 찍혀 들어오고 있었다.</p><p>누군가 내 서버에 Request Message를 매우 빠르게 보내고 있었고, 이에 내 서버는 다른 사람들의 요청을 처리하지 못한 것이다.</p><p><img data-src="https://user-images.githubusercontent.com/25674959/70389749-e9089080-1a06-11ea-80db-e957a3e6cfcc.png" alt="image" data-proofer-ignore></p><p>(누군가 장난으로 트래픽을 보내고 있었다.)</p><p> </p><h3 id="어떻게-공격했을까-">어떻게 공격했을까 ?<a href="#어떻게-공격했을까-" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><p>트래픽을 일으킨 친구에게 어떻게 했는지 물어보았고, 방법은 간단했다.</p><p><img data-src="https://user-images.githubusercontent.com/25674959/72674702-155f0480-3abd-11ea-9671-2b5b0883bb0d.png" alt="image" data-proofer-ignore></p><p>추천/섭취 버튼을 누르면, 서버로 request를 보내게 되는데 이를 이용하여 서버로 트래픽을 발생시킨 것이다.</p><p> </p><p><img data-src="https://user-images.githubusercontent.com/25674959/70493580-8d93eb00-1b4b-11ea-80cc-6a22f45235b6.png" alt="image" data-proofer-ignore></p><p>개발자 도구를 이용하여 추천 버튼에 <code class="language-plaintext highlighter-rouge">attack</code>이라는 클래스를 추가한 후, 아래와 같은 스크립트를 이용하면 된다.</p><p> </p><p><img data-src="https://user-images.githubusercontent.com/25674959/70494734-ca61e100-1b4f-11ea-9afa-decb05084df2.png" alt="image" data-proofer-ignore></p><p><code class="language-plaintext highlighter-rouge">attack(1000)</code>: 서버에 총 1000번의 request를 보낸다.</p><p> </p><h3 id="해결하는-방법">해결하는 방법<a href="#해결하는-방법" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><p>이슈를 해결하는 방법을 찾아보니</p><ol><li>자바 애플리케이션에서 해결하는 방법이 있고<ul><li>Bucket4J, RateLimitJ, RateLimiter</ul><li>웹서버(NGINX)에서 해결하는 방법 도 있었다.<ul><li>limit_req</ul></ol><p>이 중 나는 nginx에서 limit_req 모듈을 이용하여 해결하는 방법을 찾아봤다.</p><p> </p><p> </p><h2 id="limit_req-in-nginx">limit_req in Nginx<a href="#limit_req-in-nginx" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>나는 NGINX를 HTTP, HTTPS 포트로 들어오는 요청을 서버 포트로 리다이렉트시키는 용도로만 쓰고 있다.</p><p>기존의 코드는 다음과 같다.</p><p> </p><p><strong>/etc/nginx/nginx.conf</strong></p><div class="language-nginx highlighter-rouge"><div class="code-header"> <span label-text="Nginx"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre><span class="c1"># ...</span>

<span class="k">http</span> <span class="p">{</span>
    <span class="c1"># ...</span>

    <span class="kn">server</span> <span class="p">{</span>
        <span class="kn">listen</span>       <span class="mi">80</span><span class="p">;</span>
        <span class="kn">server_name</span>  <span class="s">localhost</span><span class="p">;</span>

        <span class="kn">location</span> <span class="n">/</span> <span class="p">{</span>
            <span class="kn">proxy_pass</span> <span class="s">http://localhost:4000</span><span class="p">;</span>
            <span class="kn">proxy_set_header</span> <span class="s">X-Real-IP</span> <span class="nv">$remote_addr</span><span class="p">;</span>
            <span class="kn">proxy_set_header</span> <span class="s">X-Forwarded-For</span> <span class="nv">$proxy_add_x_forwarded_for</span><span class="p">;</span>
            <span class="kn">proxy_set_header</span> <span class="s">Host</span> <span class="nv">$http_host</span><span class="p">;</span>
        <span class="p">}</span>
        
        <span class="c1"># ...</span>
    <span class="p">}</span>

<span class="p">}</span>
</pre></table></code></div></div><p>여기서 request message 를 제한할 수 있는, limit_req 를 입히면 다음과 같다.</p><p> </p><p><strong>/etc/nginx/nginx.conf</strong></p><div class="language-nginx highlighter-rouge"><div class="code-header"> <span label-text="Nginx"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre><td class="rouge-code"><pre><span class="k">http</span> <span class="p">{</span>
    <span class="c1"># ...</span>

    <span class="kn">limit_req_zone</span> <span class="nv">$binary_remote_addr</span> <span class="s">zone=one:10m</span> <span class="s">rate=1r/s</span><span class="p">;</span> <span class="c1">### 1)</span>

    <span class="kn">server</span> <span class="p">{</span>
        <span class="kn">listen</span>       <span class="mi">80</span><span class="p">;</span>
        <span class="kn">server_name</span>  <span class="s">localhost</span><span class="p">;</span>

        <span class="kn">limit_req</span> <span class="s">zone=one</span> <span class="s">burst=5</span><span class="p">;</span> <span class="c1">### 2)</span>
        
        <span class="kn">location</span> <span class="n">/</span> <span class="p">{</span>
            <span class="kn">proxy_pass</span> <span class="s">http://localhost:4000</span><span class="p">;</span>
            <span class="kn">proxy_set_header</span> <span class="s">X-Real-IP</span> <span class="nv">$remote_addr</span><span class="p">;</span>
            <span class="kn">proxy_set_header</span> <span class="s">X-Forwarded-For</span> <span class="nv">$proxy_add_x_forwarded_for</span><span class="p">;</span>
            <span class="kn">proxy_set_header</span> <span class="s">Host</span> <span class="nv">$http_host</span><span class="p">;</span>
            
            <span class="kn">limit_req_status</span>        <span class="mi">429</span><span class="p">;</span> <span class="c1">### 3)</span>
            <span class="kn">limit_req_log_level</span>     <span class="s">error</span><span class="p">;</span> <span class="c1">### 4)</span>
       <span class="p">}</span>

       <span class="c1"># ...</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><p><strong>1) <code class="language-plaintext highlighter-rouge">limit_req_zone $binary_remote_addr zone=myName:10m rate=5r/s;</code></strong></p><ul><li><code class="language-plaintext highlighter-rouge">limit_req_zone</code> <code class="language-plaintext highlighter-rouge">키</code> <code class="language-plaintext highlighter-rouge">공유 메모리 영역</code> <code class="language-plaintext highlighter-rouge">rate</code> - zone을 생성함<ul><li><code class="language-plaintext highlighter-rouge">키</code> : 요청에 limit을 걸 클라이언트 기준<ul><li>$remote_addr: 클라이언트의 IP 주소<li><strong>$binary_remote_addr</strong>: 클라이언트 IP 주소 (이진 표현)<ul><li>약 16,000 개의 IPv4에 상태 정보를 1MB에 넣을 수 있음 (64bit platform 기준)</ul></ul><li><code class="language-plaintext highlighter-rouge">공유 메모리 영역</code> : 키의 상태를 유지하는 영역의 이름과 크기<ul><li><strong>zone=myName:10m</strong>: 공유 메모리 영역 크기는 10mb, 이름은 myName<li><strong>$binary_remote_addr</strong> (클라이언트 IP 주소의 상태) 가 보관됨</ul><li><code class="language-plaintext highlighter-rouge">rate</code> : 요청 비율 제한 ( 초당요청(r/s), 분당요청(r/m) )<ul><li><strong>rate=1r/m</strong> : 1분에 1개씩 request를 Server로 보냄<li><strong>rate=12r/m</strong> : 5초에 1개씩 request를 Server로 보냄 (12request/60초 =&gt; 5초에 1request)</ul></ul></ul><p><strong>2) <code class="language-plaintext highlighter-rouge">limit_req zone=one burst=5;</code></strong></p><ul><li><code class="language-plaintext highlighter-rouge">limit_req</code> <code class="language-plaintext highlighter-rouge">zone 이름</code> <code class="language-plaintext highlighter-rouge">burst</code><ul><li><code class="language-plaintext highlighter-rouge">zone 이름</code>: 위에서 만든 zone을 가져다 씀.<li><code class="language-plaintext highlighter-rouge">burst</code>: 일종의 버킷이다.<ul><li>burst 용량을 초과하는 요청이 들어올 경우 429(Too Many Request) 에러 반환</ul></ul><li><code class="language-plaintext highlighter-rouge">burst=5</code>인 위의 경우에 7개의 요청이 동시에 들어온다면 ?<ul><li><code class="language-plaintext highlighter-rouge">Server(1개), burst(5개), Error(1개)</code></ul><li><code class="language-plaintext highlighter-rouge">burst=5</code>인 위의 경우에 6개의 요청이 동시에 들어온다면 ?<ul><li><code class="language-plaintext highlighter-rouge">Server(1개), burst(5개)</code></ul><li><code class="language-plaintext highlighter-rouge">burst=4</code>인 위의 경우에 9개의 요청이 동시에 들어온다면 ?<ul><li><code class="language-plaintext highlighter-rouge">Server(1개), burst(4개), Error(4개)</code></ul></ul><p>위의 예시는 절대적인 것은 아니다. 위의 예시들은 <code class="language-plaintext highlighter-rouge">burst</code>가 가득 차기 이전에 <code class="language-plaintext highlighter-rouge">burst</code> -&gt; <code class="language-plaintext highlighter-rouge">Server</code>로 첫 요청을 먼저 수행한다고 가정한 것. 이에 <code class="language-plaintext highlighter-rouge">Server(1개)</code> 가 담겨있는 것임.</p><p><strong>3) <code class="language-plaintext highlighter-rouge">limit_req_status 429;</code></strong></p><ul><li>이 설정을 별도로 하지 않으면 503 에러 응답<li>이 설정을 설정하면 <code class="language-plaintext highlighter-rouge">burst</code>가 가득찼을 경우 429 에러 응답</ul><p><strong>4) limit_req_log_level</strong></p><ul><li>log level을 지정할 수 있다.</ul><p> </p><h3 id="예시">예시<a href="#예시" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><p><strong>rate=12r/m, burst=5 인 Nginx에</strong></p><p><strong>한 클라이언트의 Request Message가 동시에 10개 들어온 경우</strong></p><ul><li>Ok(6개), Error(4개)<ul><li>Server(1개)<li>burst(5개)<ul><li>burst에 쌓인 Request를 5초당 1개 씩 Server로 보냄</ul><li>Error(4개)<ul><li>burst가 가득 찼으므로 에러 응답</ul></ul><li>최종 결과<ul><li>OK (1번째 Request)<ul><li>Error (7번째 Request)<li>Error (8번째 Request)<li>Error (9번째 Request)<li>Error (10번째 Request)</ul><li>OK (2번째 Request)<li>OK (3번째 Request)<li>OK (4번째 Request)<li>OK (5번째 Request)<li>OK (6번째 Request)</ul></ul><p><strong>한 클라이언트의 Request Message가 동시에 10개 들어오고,</strong><br /> <strong>7초 후에 Request Message가 동시에 2개 들어온 경우</strong></p><ul><li>Ok(7개), Error(5개)<ul><li>(0초)<ul><li>Server(1개)<li>burst(5개)<ul><li>burst에 쌓인 Request를 5초당 1개 씩 Server로 보냄</ul><li>Error(4개)<ul><li>burst가 가득 찼으므로 에러 응답</ul></ul><li>(7초)<ul><li>burst(1개)<ul><li>기존에 burst에는 4개의 Request가 대기중. 남은 공간 1개를 채움.</ul><li>Error(1개)<ul><li>burst가 가득 찼으므로 에러 응답</ul></ul><li>최종 결과<ul><li>OK (1번째 Request)<ul><li>Error (7번째 Request)<li>Error (8번째 Request)<li>Error (9번째 Request)<li>Error (10번째 Request)</ul><li>OK (2번째 Request)<ul><li>Error (12번째 Request)</ul><li>OK (3번째 Request)<li>OK (4번째 Request)<li>OK (5번째 Request)<li>OK (6번째 Request)<li>OK (11번째 Request)</ul></ul></ul><p>(서버의 요청 처리 속도에 따라 다를 수 있다. ex. <code class="language-plaintext highlighter-rouge">1번째 Request</code>는 <code class="language-plaintext highlighter-rouge">10번째 Request</code> 뒤에 찍히는 경우 )</p><p> </p><p> </p><h2 id="limit과-burst-차이">limit과 burst 차이<a href="#limit과-burst-차이" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>나는 초반에 <code class="language-plaintext highlighter-rouge">limit</code>과 <code class="language-plaintext highlighter-rouge">burst</code>가 헷갈려서 이해하는데 많은 시간을 소비했다.</p><p><code class="language-plaintext highlighter-rouge">limit</code>은 Nginx -&gt; Server 로 클라이언트 요청을 몇 초마다 보낼지를 나타내고,<br /> <code class="language-plaintext highlighter-rouge">burst</code>는 Nginx -&gt; Server 로 보낼 클라이언트 요청들을 잠시 담아두는 곳이다.</p><p>결국 <code class="language-plaintext highlighter-rouge">burst</code>에 담겨 있는 request들은 지정한 주기(limit) 마다 서버에 요청된다. <br /> <code class="language-plaintext highlighter-rouge">burst</code>가 가득 찼을 때 request가 들어오면 Nginx는 바로 에러를 응답한다.</p><p> </p><p>내가 정리한 것은 이까지고, 이 외에도 <a href="https://docs.nginx.com/nginx/admin-guide/security-controls/controlling-access-proxied-http/">공식 문서</a>에는 많은 정보들이 있다.</p><p>필요하면 다음에 다시 찾아봐야겠다.</p><p> </p><p> </p><h2 id="test">Test<a href="#test" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>누구든지 로컬에서 돌려볼 수 있도록 <a href="https://github.com/bactoria/nginx-limit-req-test">https://github.com/bactoria/nginx-limit-req-test</a> 에 공유 해두었다.</p><p><img data-src="https://user-images.githubusercontent.com/25674959/72679251-cdf26b80-3af0-11ea-824e-fbe94d8a6aa5.png" alt="" data-proofer-ignore></p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/deploy/'>Deploy</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/nginx/" class="post-tag no-text-decoration" >nginx</a> <a href="/tags/limit-req/" class="post-tag no-text-decoration" >limit_req</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> 이 기사는 저작권자의 <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> 라이센스를 따릅니다.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">공유하기</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Nginx의 limit_req 모듈 사용기 - Bactoria&url=https://bactoria.github.io/2020/01/19/Nginx%EC%9D%98-limit_req-%EB%AA%A8%EB%93%88-%EC%82%AC%EC%9A%A9%EA%B8%B0/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Nginx의 limit_req 모듈 사용기 - Bactoria&u=https://bactoria.github.io/2020/01/19/Nginx%EC%9D%98-limit_req-%EB%AA%A8%EB%93%88-%EC%82%AC%EC%9A%A9%EA%B8%B0/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Nginx의 limit_req 모듈 사용기 - Bactoria&url=https://bactoria.github.io/2020/01/19/Nginx%EC%9D%98-limit_req-%EB%AA%A8%EB%93%88-%EC%82%AC%EC%9A%A9%EA%B8%B0/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="링크 복사하기" title-succeed="링크가 복사되었습니다!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">최근 업데이트</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/2022/02/04/2022%EB%85%84-1%EC%9B%94-%ED%9A%8C%EA%B3%A0/">2022년 1월 회고</a><li><a href="/2022/01/02/2021%EB%85%84-%ED%9A%8C%EA%B3%A0/">2021년 회고</a><li><a href="/2020/04/19/%EB%A7%88%EC%8A%A4%ED%81%AC-%EA%B5%AC%EB%A7%A4-%EC%95%8C%EB%A6%AC%EB%AF%B8-%EC%84%9C%EB%B9%84%EC%8A%A4-%ED%9B%84%EA%B8%B0/">마스크 구매 알리미 서비스 후기</a><li><a href="/2021/08/15/%EA%B3%A0%EC%96%91%EC%8B%9C-%EB%85%B8%EA%B3%A0%EC%82%B0-%EB%B0%B1%ED%8C%A8%ED%82%B9/">고양시 노고산 백패킹</a><li><a href="/2021/05/16/2021%EB%85%84-19%EC%A3%BC%EC%B0%A8-%ED%9A%8C%EA%B3%A0/">2021년 19주차 회고</a></ul></div><div id="access-tags"><div class="panel-heading">인기 태그</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/%EA%B3%B5%EB%AA%A8%EC%A0%84/">공모전</a> <a class="post-tag" href="/tags/%EB%B9%85%EC%8A%A4%EB%B9%84%EC%B1%8C%EB%A6%B0%EC%A7%80/">빅스비챌린지</a> <a class="post-tag" href="/tags/%EC%9D%B4%EB%B2%88%EC%A3%BC%EC%97%90%EA%B5%AC%EB%A7%A4%ED%95%9C%EC%B1%85/">이번주에구매한책</a> <a class="post-tag" href="/tags/%EA%B0%9C%EB%B0%9C/">개발</a> <a class="post-tag" href="/tags/%EA%B5%AC%EA%B8%80%ED%81%B4%EB%9D%BC%EC%9A%B0%EB%93%9C%EC%9E%BC/">구글클라우드잼</a> <a class="post-tag" href="/tags/%EC%98%A4%EB%B8%8C%EC%A0%9D%ED%8A%B8/">오브젝트</a> <a class="post-tag" href="/tags/%EC%9A%B0%EC%95%84%ED%95%9C%ED%85%8C%ED%81%AC%EC%BD%94%EC%8A%A4/">우아한테크코스</a> <a class="post-tag" href="/tags/%EC%B7%A8%EC%97%85/">취업</a> <a class="post-tag" href="/tags/%ED%94%BC%EB%93%9C%EB%B0%B1/">피드백</a> <a class="post-tag" href="/tags/coc/">CoC</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">바로가기</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>관련된 글</h3><div class="card-deck mb-4"><div class="card"> <a href="/2019/03/06/Unable-to-acquire-JDBC-Connection/"><div class="card-body"> <em class="timeago small" date="2019-03-06 00:00:00 +0000" >2019년 03월 06일</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Unable to acquire JDBC Connection</h3><div class="text-muted small"><p> 블로그좀 들어가보려고 했더니 죽었다…   당연히 Nuxt 문제인 줄 알았는데 Server 문제였다.   서버에 /api/posts 쿼리를 날려보니 다음과 같은 응답이 왔다. { &quot;timestamp&quot;:&quot;2019-03-05T09:57:45.768+0000&quot;, &quot;status&quot;:500, &quot;error&quot;:&quot;Internal ...</p></div></div></a></div><div class="card"> <a href="/2019/01/18/Nuxt.js-%EB%B0%B0%ED%8F%AC/"><div class="card-body"> <em class="timeago small" date="2019-01-18 00:00:00 +0000" >2019년 01월 18일</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Nuxt.js 배포</h3><div class="text-muted small"><p> 작년 초, 개인블로그를 만들었다. 당시 jojoldu님의 스프링부트로 웹 서비스 출시하기의 도움을 많이 받았다.   블로그 인프라 Backend는 git push하면 배포까지 자동화였지만, Frontend는 EC2 인스턴스 내에서 빌드를 하였고, 메모리 부족으로 인스턴스가 뻗어버리는 경우가 종종 있었다.   이에, 빌드하기 전에 서버를...</p></div></div></a></div><div class="card"> <a href="/2022/02/04/2022%EB%85%84-1%EC%9B%94-%ED%9A%8C%EA%B3%A0/"><div class="card-body"> <em class="timeago small" date="2022-02-04 07:26:33 +0000" >2022년 02월 04일</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>2022년 1월 회고</h3><div class="text-muted small"><p> 코드 리뷰어 2022 공채 신입 코드리뷰어 로 활동하고 있다. 조직에 합류하기 전 인턴 때 코드 리뷰를 받으면서 많이 성장했다고 느꼈기에 나도 되돌려주고 싶었다. 코드 리뷰는 대부분 업무시간을 할애하긴 하지만, 새벽에 리뷰를 하는 경우도 있어 체력적으로 힘이 들었는데, 뉴크루가 성장하는 모습이 너무 대놓고 보여서 뿌듯함을 느낀다. 리뷰이가 앞으로 조...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/2020/01/13/2020%EB%85%84-2%EC%A3%BC%EC%B0%A8-%ED%9A%8C%EA%B3%A0/" class="btn btn-outline-primary" prompt="이전 글"><p>2020년 2주차 회고</p></a> <a href="/2020/01/20/2020%EB%85%84-3%EC%A3%BC%EC%B0%A8-%ED%9A%8C%EA%B3%A0/" class="btn btn-outline-primary" prompt="다음 글"><p>2020년 3주차 회고</p></a></div><div id="disqus_thread" class="pt-2 pb-2"><p class="text-center text-muted small"> Comments powered by <a href="https://disqus.com/">Disqus</a>.</p></div><script type="text/javascript"> var disqus_config = function () { this.page.url = 'https://bactoria.github.io/2020/01/19/Nginx%EC%9D%98-limit_req-%EB%AA%A8%EB%93%88-%EC%82%AC%EC%9A%A9%EA%B8%B0/'; this.page.identifier = '/2020/01/19/Nginx%EC%9D%98-limit_req-%EB%AA%A8%EB%93%88-%EC%82%AC%EC%9A%A9%EA%B8%B0/'; }; /* Lazy loading */ var disqus_observer = new IntersectionObserver(function (entries) { if(entries[0].isIntersecting) { (function () { var d = document, s = d.createElement('script'); s.src = 'https://bactoria.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); disqus_observer.disconnect(); } }, { threshold: [0] }); disqus_observer.observe(document.querySelector('#disqus_thread')); /* Auto switch theme */ function reloadDisqus() { /* Disqus hasn't been loaded */ if (typeof DISQUS === "undefined") { return; } if (document.readyState == 'complete') { DISQUS.reset({ reload: true, config: disqus_config }); } } const modeToggle = document.querySelector(".mode-toggle"); if (typeof modeToggle !== "undefined") { /* modeToggle.addEventListener('click', reloadDisqus); // not pretty for 'color-scheme' */ window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', reloadDisqus); } </script></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://github.com/bactoria">bactoria</a>. <span data-toggle="tooltip" data-placement="top" title="명시되지 않는 한 이 사이트의 블로그 게시물은 작성자의 Creative Commons Attribution 4.0 International(CC BY 4.0) 라이선스에 따라 사용이 허가되었습니다.">일부 권리 보유</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">인기 태그</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/%EA%B3%B5%EB%AA%A8%EC%A0%84/">공모전</a> <a class="post-tag" href="/tags/%EB%B9%85%EC%8A%A4%EB%B9%84%EC%B1%8C%EB%A6%B0%EC%A7%80/">빅스비챌린지</a> <a class="post-tag" href="/tags/%EC%9D%B4%EB%B2%88%EC%A3%BC%EC%97%90%EA%B5%AC%EB%A7%A4%ED%95%9C%EC%B1%85/">이번주에구매한책</a> <a class="post-tag" href="/tags/%EA%B0%9C%EB%B0%9C/">개발</a> <a class="post-tag" href="/tags/%EA%B5%AC%EA%B8%80%ED%81%B4%EB%9D%BC%EC%9A%B0%EB%93%9C%EC%9E%BC/">구글클라우드잼</a> <a class="post-tag" href="/tags/%EC%98%A4%EB%B8%8C%EC%A0%9D%ED%8A%B8/">오브젝트</a> <a class="post-tag" href="/tags/%EC%9A%B0%EC%95%84%ED%95%9C%ED%85%8C%ED%81%AC%EC%BD%94%EC%8A%A4/">우아한테크코스</a> <a class="post-tag" href="/tags/%EC%B7%A8%EC%97%85/">취업</a> <a class="post-tag" href="/tags/%ED%94%BC%EB%93%9C%EB%B0%B1/">피드백</a> <a class="post-tag" href="/tags/coc/">CoC</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">검색 결과가 없습니다.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script>
